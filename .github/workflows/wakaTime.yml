name: Coding
on:
    schedule:
        - cron: '58 23 * * 1-5'
jobs:
    scrobbler:
        runs-on: windows-latest
        steps:
        - uses: actions/checkout@master
        - name: init proccess
          run: |
            $Year = Get-Date -UFormat %Y
            $Month = Get-Date -UFormat %m

            if (!(Test-Path -Path $Year)) {
                New-Item -Path $Year -ItemType Directory
            }

            if (!(Test-Path -Path ${Year}\\${Month})) {
                New-Item -Path $Year\$Month -ItemType Directory
            }

            pip install requests

            python wakatime\script.py --path "$Year" -t ${{ secrets.TOKEN_WAKATIME }}

            git add "$Year/$Month"
        - name: Commit & Push changes
          uses: actions-js/push@master
          with:
            github_token: ${{ secrets.TOKEN }}
            author_name: EdgarVaguencia
            author_email: ${{ secrets.EMAIL }}
            message: 'Dandole atomos :metal:'
